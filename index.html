<html>
<body>
<button onclick="onButtonClick()">Click me</button>
<script>
async function onButtonClick() {  
  let options = {};
  options.acceptAllAdvertisements = true;

  try {
    console.log('Requesting Bluetooth Scan with options: ' + JSON.stringify(options));
    const scan = await navigator.bluetooth.requestLEScan(options);

    console.log('Scan started with:');
    console.log(' acceptAllAdvertisements: ' + scan.acceptAllAdvertisements);
    console.log(' active: ' + scan.active);
    console.log(' keepRepeatedDevices: ' + scan.keepRepeatedDevices);
    console.log(' filters: ' + JSON.stringify(scan.filters));

    navigator.bluetooth.addEventListener('advertisementreceived', event => {
      console.log('Advertisement received.');
    });

    setTimeout(stopScan, 10000);
    function stopScan() {
      console.log('Stopping scan...');
      scan.stop();
      console.log('Stopped.  scan.active = ' + scan.active);
    }
  } catch(error)  {
    console.log('Argh! ' + error);
  }
}
</script>
</body>
</html>
